package com.example.myapplication

import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.compose.foundation.background
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.shape.CircleShape
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.*
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.clip
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.vector.ImageVector
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.text.style.TextOverflow
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import com.example.myapplication.ui.theme.MyApplicationTheme
import kotlinx.coroutines.launch

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            MyApplicationTheme {
                TelegramChatApp()
            }
        }
    }
}

// –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —á–∞—Ç–∞
data class Chat(
    val id: Int,
    val name: String,
    val lastMessage: String,
    val time: String,
    val unreadCount: Int = 0,
    val isOnline: Boolean = false,
    val avatarColor: Color
)

// –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
data class Message(
    val id: Int,
    val text: String,
    val time: String,
    val isFromMe: Boolean
)

// –ü—É–Ω–∫—Ç—ã –º–µ–Ω—é –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
data class DrawerMenuItem(
    val icon: ImageVector,
    val title: String
)

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun TelegramChatApp() {
    val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)
    val scope = rememberCoroutineScope()
    var selectedChat by remember { mutableStateOf<Chat?>(null) }
    
    // –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
    val chats = remember {
        listOf(
            Chat(1, "–ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤", "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?", "12:45", 2, true, Color(0xFF5C6BC0)),
            Chat(2, "–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞", "–í—Å—Ç—Ä–µ—á–∞ –≤ 15:00", "11:30", 5, false, Color(0xFF26A69A)),
            Chat(3, "–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞", "–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å!", "10:15", 0, true, Color(0xFFEF5350)),
            Chat(4, "–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞", "–í–∞—à –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω", "–í—á–µ—Ä–∞", 0, false, Color(0xFFFF7043)),
            Chat(5, "–î–º–∏—Ç—Ä–∏–π –°–∏–¥–æ—Ä–æ–≤", "–î–æ–∫—É–º–µ–Ω—Ç—ã –æ—Ç–ø—Ä–∞–≤–∏–ª", "–í—á–µ—Ä–∞", 1, false, Color(0xFF42A5F5)),
            Chat(6, "–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞", "–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è!", "–ü–Ω", 0, true, Color(0xFFAB47BC)),
            Chat(7, "–†–∞–±–æ—Ç–∞", "–û—Ç—á–µ—Ç –≥–æ—Ç–æ–≤ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ", "–ü–Ω", 3, false, Color(0xFF66BB6A)),
            Chat(8, "–°–µ–º—å—è", "–§–æ—Ç–æ —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞ üì∑", "–í—Å", 0, false, Color(0xFFFFCA28))
        )
    }
    
    // –ü—É–Ω–∫—Ç—ã –º–µ–Ω—é
    val menuItems = listOf(
        DrawerMenuItem(Icons.Filled.Person, "–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å"),
        DrawerMenuItem(Icons.Filled.Group, "–ù–æ–≤–∞—è –≥—Ä—É–ø–ø–∞"),
        DrawerMenuItem(Icons.Filled.Call, "–ó–≤–æ–Ω–∫–∏"),
        DrawerMenuItem(Icons.Filled.Bookmark, "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"),
        DrawerMenuItem(Icons.Filled.Settings, "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"),
        DrawerMenuItem(Icons.Filled.Help, "–ü–æ–º–æ—â—å")
    )
    
    ModalNavigationDrawer(
        drawerState = drawerState,
        drawerContent = {
            ModalDrawerSheet(
                modifier = Modifier.width(300.dp),
                drawerContainerColor = Color(0xFF1E1E2E)
            ) {
                DrawerContent(menuItems)
            }
        }
    ) {
        Row(modifier = Modifier.fillMaxSize()) {
            // –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ —Å–ª–µ–≤–∞
            ChatListPanel(
                chats = chats,
                selectedChat = selectedChat,
                onChatSelected = { selectedChat = it },
                onMenuClick = { scope.launch { drawerState.open() } },
                modifier = Modifier.weight(0.35f)
            )
            
            // –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ —Å–ø—Ä–∞–≤–∞
            if (selectedChat != null) {
                ChatScreen(
                    chat = selectedChat!!,
                    modifier = Modifier.weight(0.65f)
                )
            } else {
                EmptyChatScreen(modifier = Modifier.weight(0.65f))
            }
        }
    }
}

@Composable
fun DrawerContent(menuItems: List<DrawerMenuItem>) {
    Column(modifier = Modifier.fillMaxSize()) {
        // –®–∞–ø–∫–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º
        Box(
            modifier = Modifier
                .fillMaxWidth()
                .height(180.dp)
                .background(Color(0xFF5B8DEF))
                .padding(16.dp)
        ) {
            Column(
                modifier = Modifier.align(Alignment.BottomStart)
            ) {
                Box(
                    modifier = Modifier
                        .size(64.dp)
                        .clip(CircleShape)
                        .background(Color(0xFF3D5AFE)),
                    contentAlignment = Alignment.Center
                ) {
                    Text(
                        text = "–ò–ü",
                        color = Color.White,
                        fontSize = 24.sp,
                        fontWeight = FontWeight.Bold
                    )
                }
                Spacer(modifier = Modifier.height(12.dp))
                Text(
                    text = "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
                    color = Color.White,
                    fontSize = 18.sp,
                    fontWeight = FontWeight.Medium
                )
                Text(
                    text = "+7 999 123-45-67",
                    color = Color.White.copy(alpha = 0.8f),
                    fontSize = 14.sp
                )
            }
        }
        
        Spacer(modifier = Modifier.height(8.dp))
        
        // –ü—É–Ω–∫—Ç—ã –º–µ–Ω—é
        menuItems.forEach { item ->
            NavigationDrawerItem(
                icon = { Icon(item.icon, contentDescription = null, tint = Color.White) },
                label = { Text(item.title, color = Color.White) },
                selected = false,
                onClick = { },
                colors = NavigationDrawerItemDefaults.colors(
                    unselectedContainerColor = Color.Transparent
                ),
                modifier = Modifier.padding(horizontal = 12.dp)
            )
        }
        
        Spacer(modifier = Modifier.weight(1f))
        
        // –í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        Text(
            text = "Telegram Clone v1.0",
            color = Color.Gray,
            fontSize = 12.sp,
            modifier = Modifier.padding(16.dp)
        )
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun ChatListPanel(
    chats: List<Chat>,
    selectedChat: Chat?,
    onChatSelected: (Chat) -> Unit,
    onMenuClick: () -> Unit,
    modifier: Modifier = Modifier
) {
    Column(
        modifier = modifier
            .fillMaxHeight()
            .background(Color(0xFF17212B))
    ) {
        // –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å
        TopAppBar(
            title = {
                Text(
                    "Telegram",
                    color = Color.White,
                    fontWeight = FontWeight.Bold
                )
            },
            navigationIcon = {
                IconButton(onClick = onMenuClick) {
                    Icon(
                        Icons.Filled.Menu,
                        contentDescription = "Menu",
                        tint = Color.White
                    )
                }
            },
            actions = {
                IconButton(onClick = { }) {
                    Icon(
                        Icons.Filled.Search,
                        contentDescription = "Search",
                        tint = Color.White
                    )
                }
            },
            colors = TopAppBarDefaults.topAppBarColors(
                containerColor = Color(0xFF232E3C)
            )
        )
        
        // –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
        LazyColumn(modifier = Modifier.fillMaxSize()) {
            items(chats) { chat ->
                ChatListItem(
                    chat = chat,
                    isSelected = chat == selectedChat,
                    onClick = { onChatSelected(chat) }
                )
            }
        }
    }
}

@Composable
fun ChatListItem(
    chat: Chat,
    isSelected: Boolean,
    onClick: () -> Unit
) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .background(if (isSelected) Color(0xFF2B5278) else Color.Transparent)
            .clickable(onClick = onClick)
            .padding(horizontal = 12.dp, vertical = 10.dp),
        verticalAlignment = Alignment.CenterVertically
    ) {
        // –ê–≤–∞—Ç–∞—Ä
        Box(contentAlignment = Alignment.BottomEnd) {
            Box(
                modifier = Modifier
                    .size(52.dp)
                    .clip(CircleShape)
                    .background(chat.avatarColor),
                contentAlignment = Alignment.Center
            ) {
                Text(
                    text = chat.name.take(2).uppercase(),
                    color = Color.White,
                    fontSize = 18.sp,
                    fontWeight = FontWeight.Medium
                )
            }
            if (chat.isOnline) {
                Box(
                    modifier = Modifier
                        .size(14.dp)
                        .clip(CircleShape)
                        .background(Color(0xFF17212B))
                        .padding(2.dp)
                ) {
                    Box(
                        modifier = Modifier
                            .fillMaxSize()
                            .clip(CircleShape)
                            .background(Color(0xFF4CAF50))
                    )
                }
            }
        }
        
        Spacer(modifier = Modifier.width(12.dp))
        
        Column(modifier = Modifier.weight(1f)) {
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.SpaceBetween,
                verticalAlignment = Alignment.CenterVertically
            ) {
                Text(
                    text = chat.name,
                    color = Color.White,
                    fontSize = 16.sp,
                    fontWeight = FontWeight.Medium,
                    maxLines = 1,
                    overflow = TextOverflow.Ellipsis,
                    modifier = Modifier.weight(1f)
                )
                Text(
                    text = chat.time,
                    color = if (chat.unreadCount > 0) Color(0xFF5B8DEF) else Color.Gray,
                    fontSize = 12.sp
                )
            }
            
            Spacer(modifier = Modifier.height(4.dp))
            
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.SpaceBetween,
                verticalAlignment = Alignment.CenterVertically
            ) {
                Text(
                    text = chat.lastMessage,
                    color = Color.Gray,
                    fontSize = 14.sp,
                    maxLines = 1,
                    overflow = TextOverflow.Ellipsis,
                    modifier = Modifier.weight(1f)
                )
                if (chat.unreadCount > 0) {
                    Box(
                        modifier = Modifier
                            .size(22.dp)
                            .clip(CircleShape)
                            .background(Color(0xFF5B8DEF)),
                        contentAlignment = Alignment.Center
                    ) {
                        Text(
                            text = chat.unreadCount.toString(),
                            color = Color.White,
                            fontSize = 12.sp,
                            fontWeight = FontWeight.Bold
                        )
                    }
                }
            }
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun ChatScreen(
    chat: Chat,
    modifier: Modifier = Modifier
) {
    val messages = remember {
        listOf(
            Message(1, "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?", "12:30", false),
            Message(2, "–ü—Ä–∏–≤–µ—Ç! –í—Å–µ –æ—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ!", "12:32", true),
            Message(3, "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ?", "12:33", false),
            Message(4, "–†–∞–±–æ—Ç–∞—é –Ω–∞–¥ –Ω–æ–≤—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º. –û—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!", "12:35", true),
            Message(5, "–ó–≤—É—á–∏—Ç –∑–¥–æ—Ä–æ–≤–æ! –†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ", "12:40", false),
            Message(6, "–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –≤ —Å—Ç–∏–ª–µ Telegram üòä", "12:42", true),
            Message(7, "–í–∞—É, –∫—Ä—É—Ç–æ! –ü–æ–∫–∞–∂–µ—à—å –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—à—å?", "12:45", false)
        )
    }
    
    var messageText by remember { mutableStateOf("") }
    
    Column(
        modifier = modifier
            .fillMaxHeight()
            .background(Color(0xFF0E1621))
    ) {
        // –®–∞–ø–∫–∞ —á–∞—Ç–∞
        TopAppBar(
            title = {
                Row(verticalAlignment = Alignment.CenterVertically) {
                    Box(
                        modifier = Modifier
                            .size(40.dp)
                            .clip(CircleShape)
                            .background(chat.avatarColor),
                        contentAlignment = Alignment.Center
                    ) {
                        Text(
                            text = chat.name.take(2).uppercase(),
                            color = Color.White,
                            fontSize = 14.sp,
                            fontWeight = FontWeight.Medium
                        )
                    }
                    Spacer(modifier = Modifier.width(12.dp))
                    Column {
                        Text(
                            text = chat.name,
                            color = Color.White,
                            fontSize = 16.sp,
                            fontWeight = FontWeight.Medium
                        )
                        Text(
                            text = if (chat.isOnline) "–≤ —Å–µ—Ç–∏" else "–±—ã–ª(–∞) –Ω–µ–¥–∞–≤–Ω–æ",
                            color = if (chat.isOnline) Color(0xFF4CAF50) else Color.Gray,
                            fontSize = 12.sp
                        )
                    }
                }
            },
            actions = {
                IconButton(onClick = { }) {
                    Icon(Icons.Filled.Call, contentDescription = "Call", tint = Color.White)
                }
                IconButton(onClick = { }) {
                    Icon(Icons.Filled.MoreVert, contentDescription = "More", tint = Color.White)
                }
            },
            colors = TopAppBarDefaults.topAppBarColors(
                containerColor = Color(0xFF17212B)
            )
        )
        
        // –°–æ–æ–±—â–µ–Ω–∏—è
        LazyColumn(
            modifier = Modifier
                .weight(1f)
                .fillMaxWidth()
                .padding(horizontal = 8.dp),
            reverseLayout = true
        ) {
            items(messages.reversed()) { message ->
                MessageBubble(message = message)
            }
        }
        
        // –ü–æ–ª–µ –≤–≤–æ–¥–∞
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .background(Color(0xFF17212B))
                .padding(8.dp),
            verticalAlignment = Alignment.CenterVertically
        ) {
            IconButton(onClick = { }) {
                Icon(Icons.Filled.AttachFile, contentDescription = "Attach", tint = Color.Gray)
            }
            
            TextField(
                value = messageText,
                onValueChange = { messageText = it },
                placeholder = { Text("–°–æ–æ–±—â–µ–Ω–∏–µ", color = Color.Gray) },
                colors = TextFieldDefaults.colors(
                    focusedContainerColor = Color(0xFF242F3D),
                    unfocusedContainerColor = Color(0xFF242F3D),
                    focusedTextColor = Color.White,
                    unfocusedTextColor = Color.White,
                    cursorColor = Color(0xFF5B8DEF),
                    focusedIndicatorColor = Color.Transparent,
                    unfocusedIndicatorColor = Color.Transparent
                ),
                shape = RoundedCornerShape(20.dp),
                modifier = Modifier
                    .weight(1f)
                    .height(48.dp)
            )
            
            IconButton(onClick = { }) {
                Icon(Icons.Filled.EmojiEmotions, contentDescription = "Emoji", tint = Color.Gray)
            }
            
            IconButton(onClick = { }) {
                Icon(
                    if (messageText.isNotEmpty()) Icons.Filled.Send else Icons.Filled.Mic,
                    contentDescription = "Send",
                    tint = Color(0xFF5B8DEF)
                )
            }
        }
    }
}

@Composable
fun MessageBubble(message: Message) {
    Box(
        modifier = Modifier
            .fillMaxWidth()
            .padding(vertical = 4.dp),
        contentAlignment = if (message.isFromMe) Alignment.CenterEnd else Alignment.CenterStart
    ) {
        Box(
            modifier = Modifier
                .widthIn(max = 280.dp)
                .clip(RoundedCornerShape(
                    topStart = 16.dp,
                    topEnd = 16.dp,
                    bottomStart = if (message.isFromMe) 16.dp else 4.dp,
                    bottomEnd = if (message.isFromMe) 4.dp else 16.dp
                ))
                .background(
                    if (message.isFromMe) Color(0xFF2B5278) else Color(0xFF182533)
                )
                .padding(horizontal = 12.dp, vertical = 8.dp)
        ) {
            Column {
                Text(
                    text = message.text,
                    color = Color.White,
                    fontSize = 15.sp
                )
                Text(
                    text = message.time,
                    color = Color.Gray,
                    fontSize = 11.sp,
                    modifier = Modifier.align(Alignment.End)
                )
            }
        }
    }
}

@Composable
fun EmptyChatScreen(modifier: Modifier = Modifier) {
    Box(
        modifier = modifier
            .fillMaxHeight()
            .background(Color(0xFF0E1621)),
        contentAlignment = Alignment.Center
    ) {
        Column(
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Icon(
                Icons.Filled.Chat,
                contentDescription = null,
                tint = Color.Gray,
                modifier = Modifier.size(80.dp)
            )
            Spacer(modifier = Modifier.height(16.dp))
            Text(
                text = "–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç",
                color = Color.Gray,
                fontSize = 18.sp
            )
            Text(
                text = "—á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ",
                color = Color.Gray.copy(alpha = 0.7f),
                fontSize = 14.sp
            )
        }
    }
}
package com.example.myapplication.ui.theme

import android.app.Activity
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.darkColorScheme
import androidx.compose.runtime.Composable
import androidx.compose.runtime.SideEffect
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.toArgb
import androidx.compose.ui.platform.LocalView
import androidx.core.view.WindowCompat

val TelegramBlue = Color(0xFF5B8DEF)
val TelegramDarkBg = Color(0xFF17212B)
val TelegramDarkSurface = Color(0xFF232E3C)

private val DarkColorScheme = darkColorScheme(
    primary = TelegramBlue,
    onPrimary = Color.White,
    secondary = Color(0xFF4CAF50),
    background = TelegramDarkBg,
    surface = TelegramDarkSurface,
    onBackground = Color.White,
    onSurface = Color.White
)

@Composable
fun MyApplicationTheme(
    content: @Composable () -> Unit
) {
    val view = LocalView.current
    if (!view.isInEditMode) {
        SideEffect {
            val window = (view.context as Activity).window
            window.statusBarColor = TelegramDarkSurface.toArgb()
            WindowCompat.getInsetsController(window, view).isAppearanceLightStatusBars = false
        }
    }

    MaterialTheme(
        colorScheme = DarkColorScheme,
        content = content
    )
}



		
